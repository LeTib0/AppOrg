<template name="tasksBoard">
    <div class="container">
        <button class="btn btn-lg btn-outline-success js-open-add-task-modal">Ajouter Tache</button>
    </div>
    <form action="" class="js-create-quick-task">
        <div>
            <h3>Ajout de tache rapide</h3>
        </div> 
        <div class="form-row">       
            <div class="col-md-6">
                <input type="text" class="form-control mb-2" required="true" placeholder="Titre" name="quickTaskTitle">
            </div>
            <div class="col-md-4">
                <input type="text" list="quikTaskCategori" required="true" class="form-control mb-2" placeholder="Catégorie" name="quikTaskCategori">
                <datalist id="quikTaskCategori">
                    {{#each categori in mesCategories}}
                        <option >{{categori.name}}</option>
                    {{/each}}
                </datalist>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn  btn-outline-success">Valider </button> 
            </div>
        </div>
    </form>
    <div >
        <div> <h3> Liste des Taches</h3></div>
        {{#each task in myTasks}}
            <div>
                <table class="table table-hover table-dark">
                    <thead >
                        <tr>
                            <th scope="col-md-4">Tache</th>
                            <th scope="col-md-3">Categorie</th>
                            <th scope="col-md-2">Priorité</th>
                            <th scope="col-md-2">Etat</th>
                            <th scope="col-md-1"> + </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <form action="" class="js-change-title">
                                    <input type="text" id={{task._id}} name="changeTaskTitle" class="form-control mb-1" value="{{task.taskTitle}}">
                                    <button class="btn btn-secondary btn-sm">Modifier</button>
                                </form>
                            </td>
                            <td>
                                <form action="" class="js-change-categorie">
                                    <input type="text" id={{task._id}} list="listTaskCategori" class="form-control mb-1" value="{{task.taskCategori}}" name="changeCategori">
                                    <datalist id="listTaskCategori">
                                        {{#each categori in mesCategories}}
                                            <option >{{categori.name}}</option>
                                        {{/each}}
                                    </datalist>
                                    <button class="btn btn-secondary btn-sm">Modifier</button>
                                </form>
                            </td>
                            <td>
                                <div class="dropdown">
                                    <button class="btn btn-secondary dropdown-toggle"  role="button" id="dropdownPriority" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        {{#if task.taskPriority}}
                                            {{task.taskPriority}}
                                            {{else}}
                                            Choisir
                                        {{/if}}
                                    </button>
                                    
                                    <div class="dropdown-menu" aria-labelledby="dropdownPriority">
                                        <button id={{task._id}} value="normal" class="dropdown-item js-change-priority-to" >Normal </button>
                                        <button id={{task._id}} value="faible" class="dropdown-item js-change-priority-to" >Faible</button>
                                        <button id={{task._id}} value="forte" class="dropdown-item js-change-priority-to" >Forte</button>
                                        <button id={{task._id}} value="urgente" class="dropdown-item js-change-priority-to" >Urgente</button>
                                        <button id={{task._id}} value="absolue" class="dropdown-item js-change-priority-to" >Absolue</button>

                                    </div>
                                </div>
                            </td>
                            <!-- <td>
                                <div class="dropdown">
                                    <button class="btn btn-secondary dropdown-toggle"  role="button" id="dropdownAction" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        Action
                                    </button>
                                    
                                    <div class="dropdown-menu" aria-labelledby="dropdownAction">
                                        <button class="dropdown-item" >Modifier</button>
                                        <button class="dropdown-item" >Archiver</button>
                                    </div>
                                </div>
                            </td> -->
                            <td>
                                <div class="dropdown">
                                    <button class="btn btn-secondary dropdown-toggle"  role="button" id="dropdownState" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        {{#if task.taskState}}
                                            {{task.taskState}}
                                            {{else}}
                                            Choisir
                                        {{/if}}
                                    </button>
                                    
                                    <div class="dropdown-menu" aria-labelledby="dropdownState">
                                        <button id={{task._id}} value="A Faire" class="dropdown-item js-change-state-to" >A Faire </button>
                                        <button id={{task._id}} value="En Cours" class="dropdown-item js-change-state-to" >En Cours</button>
                                        <button id={{task._id}} value="A tester" class="dropdown-item js-change-state-to" >A tester</button>
                                        <button id={{task._id}} value="Fini" class="dropdown-item js-change-state-to" >Fini</button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#collapseTask{{task._id}}" aria-expanded="false" aria-controls="collapseExample">
                                    +
                                </button>
                            </td>

                        </tr>
                    </tbody>
                    <tbody  class="collapse" id="collapseTask{{task._id}}">
                        <tr>
                            <th scope="col-md-3"> Date Début: {{task.startDate}}
                                <form action="" class="js-change-start-date">
                                    <div class="row">
                                        <div class="col-md-8"><input type="date" name="taskStartDate" id={{task._id}} class="form-control mb-1"></div>
                                        <div class="col-md-4"><button type="submit" class="btn btn-secondary ">Modifier</button></div>
                                    </div>
                                </form>
                            </th>
                            <th scope="col-md-3">
                                Date Fin: {{task.endDate}}
                                <form action="">
                                    <div class="row">
                                    <div class="col-md-8"><input type="date" name="" id="" class="form-control mb-1"></div>
                                    <div class="col-md-4"><button class="btn btn-secondary ">Modifier</button></div>
                                    </div>
                                </form>
                            </th>

                            <th scope="col-md-3">
                                <!-- <div class="row">  -->
                                    Difficultée
                                    <div class="dropdown">
                                        <button class="btn btn-secondary dropdown-toggle"  role="button" id="dropdownWeight" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            {{#if task.taskWeight}}
                                                {{task.taskWeight}}
                                                {{else}}
                                                /
                                            {{/if}}
                                        </button>
                                        <div class="dropdown-menu" aria-labelledby="dropdownWeight">
                                            <button value="1" id={{task._id}} class="dropdown-item js-change-weight-to" >1</button>
                                            <button value="2" id={{task._id}} class="dropdown-item js-change-weight-to" >2</button>
                                            <button value="3" id={{task._id}} class="dropdown-item js-change-weight-to" >3</button>
                                            <button value="5" id={{task._id}} class="dropdown-item js-change-weight-to" >5</button>
                                            <button value="8" id={{task._id}} class="dropdown-item js-change-weight-to" >8</button>
                                            <button value="13" id={{task._id}} class="dropdown-item js-change-weight-to" >13</button>
                                            <button value="21" id={{task._id}} class="dropdown-item js-change-weight-to" >21</button>
                                        </div>
                                    </div>
                                <!-- </div> -->
                            </th>
                            <th scope="col-md-3">
                                Note
                                <div class="dropdown">
                                    <button class="btn btn-secondary dropdown-toggle"  role="button" id="dropdownGrade" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        {{#if task.taskGrade}}
                                            {{task.taskGrade}}/5
                                            {{else}}
                                            ?/5
                                        {{/if}}
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdownGrade">
                                        <button value="1" id={{task._id}} class="dropdown-item js-change-grade-to" >1</button>
                                        <button value="2" id={{task._id}} class="dropdown-item js-change-grade-to" >2</button>
                                        <button value="3" id={{task._id}} class="dropdown-item js-change-grade-to" >3</button>
                                        <button value="4" id={{task._id}} class="dropdown-item js-change-grade-to" >4</button>
                                        <button value="5" id={{task._id}} class="dropdown-item js-change-grade-to" >5</button>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </tbody>
                </table>
            </div>


        {{/each}}
    </div>

</template>

<template name="createTaskForm">
    <div class="card my-2">
        <h3 class="card-header">Ajouter Tache</h3>
        <div class="card-body">
            <form class="js-create-task" method="post">
                <div class="form-row">
                    <div class="col-md-8">
                        <input type="text" class="form-control mb-2" placeholder="Titre" name="taskTitle">
                    </div>
                    <div class="col-md-4">
                        <input type="text" list="categorie" class="form-control mb-2" placeholder="Catégorie" name="taskCategori">
                        <datalist id="categorie">
                            {{#each categori in mesCategories}}
                                <option >{{categori.name}}</option>
                            {{/each}}
                        </datalist>
                    </div>
                </div>
                <textarea name="description"  rows="2" class="form-control mb-2" placeholder="Déscription"></textarea>
                <div class="form-row ">
                    <div class="col-md-6 form-control  mb-2">
                        <div>
                            <label for="startDate"> Date Début </label>
                        </div>
                        <div>
                            <input type="datetime-local" name="startDate" id="startDate">
                        </div>
                    </div>
                    <div class="col-md-6 form-control  mb-2">
                            <div>
                                <label for="endDate"> Date Fin </label>
                            </div>
                            <div>
                                <input type="datetime-local" name="endDate" id="endDate">
                            </div>
                    </div>
                </div>    
                <div class="form-row ">
                    <div class="col-md-6 form-control  mb-2">
                        <div>
                            <label for="taskPriority"> Prioriété  </label>
                        </div>
                        <div>
                            <select class="custom-select" name="taskPriority">
                                <option value="normal" selected  >Normale</option>
                                <option value="low">Faible</option>
                                <option value="strong">Forte</option>
                                <option value="srongly">Urgente</option>
                                <option value="abslolute">Absolue</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6 form-control  mb-2">
                        <div>
                            <label for="taskWeight"> Poid  </label>
                        </div>
                        <div>
                            <select class="custom-select" name="taskWeight">
                                <option value="1" selected  >1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="5">5</option>
                                <option value="8">8</option>
                                <option value="13">13</option>
                                <option value="21">21</option>

                            </select>
                        </div>
                    </div>
                </div> 
                <div class="form-row ">
                    <div class="col-md-6 form-control  mb-2">
                        <div>
                            <label for="taskState"> Etat </label>
                        </div>
                        <div>
                            <select class="custom-select" name="taskState">
                                <option value="A Faire" selected  >A Faire</option>
                                <option value="En Cours">En Cours</option>
                                <option value="A Tester">A Tester</option>
                                <option value="Fini">Fini</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6 form-control  mb-2">
                        <div>
                            <label for="taskTimeEstimed"> Temps Estimé </label>
                        </div>
                        <div>
                            <input type="time" name="taskTimeEstimed" id="taskTimeEstimed">
                        </div>
                    </div>
                </div> 
                    <!-- <div class="col-md-12 form-control btn btn-outline-success js-add-task mb-2">
                        <h5>Ajouter</h5>
                    </div>    -->
                <button type="submit" class="btn btn-lg btn-outline-success">Valider </button> 
            </form>
        </div>
    </div>

</template>

<template name="addTaskModal">
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                {{> createTaskForm}}
            </div>
        </div>
    </div>
</template>